%!TEX program = xelatex
\documentclass{ctexart}
\usepackage{amsmath}
\usepackage[table]{xcolor}
\usepackage{geometry}
\usepackage{fancyhdr}
\usepackage{float}
\pagestyle{fancy}
\fancyhf{}
\geometry{a4paper,left=2.5cm,right=2.5cm}
\usepackage{graphicx}
\usepackage{amssymb}
\title{“拍照赚钱”的任务定价策略}
\cfoot{\thepage}
\date{}
\begin{document}
\maketitle
\begin{abstract}
移动互联网时代实现了照片拍摄市场与摄影师之间的实时互通，本文应用曲线拟合的手段，结合图像分析，对不同位置的任务的定价问题进行了分析。研究了原有定价方案与供需关系的进一步优化,于已有数据进行聚簇分析，化简了繁冗的现实模型，

针对问题一，从附录一获取资料之后，首先用散点图画出了任务的位置分布情况，为了讨论定价规律，我们选位置的经纬作为考察变量，利用典型相关分析求位置、价格和完成度的相关系数。发现他们的弱相关关系后，我们就利用集簇的思想，把图划分为几个区域，并利用聚簇分析网格法分别讨论个区域的定价情况。最后，建立任务完成度函数T = f(K)作为指标，得了任务完成率与区域关系的的数学模型，并综合附录二的数据，利用曲线算法拟合得到了任务完成度模型，并将其利用于评价任务未完成的原因。

针对问题二，首先统计原定价与完成率的关系，再用线性回归确定任务总数与总价的关系，发现了二者之间的关系。于是我们用拟合的方法，得出重新定价后的价格的拟合函数。由于价格与完成数之间决定采用贪心算法，在固定完成率的情况下，降低区域价格来减少总价格，积累局部最优解来得到一个优化方案一次来优化定价，实现在任务完成度不变的情况下将总价格降低。


针对问题三，考虑到任务分布呈簇集形状，区域性高，于是通过k-mean算法对数据进行分类，把距离相近的任务打包发布，然后

针对问题四，我们主要利用问题(2)中的重新优化改进的数学模型，重新套用问题(2)模型对问题进行解决。

我们结合实际的APP软件以及会员分布情况，对之前的所有模型做出了客观评价以及优化。
[关键词] 典型相关分析\ 聚簇分析\ 贪心算法\ k-means聚类
\end{abstract}
\newpage
\section{问题重述与提出}
“拍照赚钱”是移动互联网下的一种自助式服务模式。用户下载APP，注册成为APP的会员，然后从APP上领取需要拍照的任务（比如上超市去检查某种商品的上架情况），赚取APP对任务所标定的酬金。这种基于移动互联网的自助式劳务众包平台，为企业提供各种商业检查和信息搜集，相比传统的市场调查方式可以大大节省调查成本，而且有效地保证了调查数据真实性，缩短了调查的周期。因此APP成为该平台运行的核心，而APP中的任务定价又是其核心要素。如果定价不合理，有的任务就会无人问津，而导致商品检查的失败。

1.研究附件一中项目的任务定价规律，分析任务未完成的原因。

2.为附件一中的项目设计新的任务定价方案，并和原方案进行比较。

3.实际情况下，多个任务可能因为位置比较集中，导致用户会争相选择，一种考虑是将这些任务联合在一起打包发布。在这种考虑下，如何修改前面的定价模型，对最终的任务完成情况又有什么影响？

4.对附件三中的新项目给出你的任务定价方案，并评价该方案的实施效果。
\section{符号说明}
\begin{table}[htbp]\large
\centering
\begin{tabular}{|c|c|}
\hline
符号&说明\\
\hline
$P$&任务价格\\
\hline
$m$&支出\\
\hline
n&会员数\\
\hline
N&加权会员数\\
\hline
$\gamma$&平均完成率\\
\hline
\end{tabular}
\end{table}
\section{基本假设}
1.每个会员每次只接单1单，不同时接单2单

2.默认每天的天气都正常，不考虑天气因素导致会员不接单

3.会员能及时收到预订信息

4.每单完成得到的利润数是相同的

5.在整个定价过程中，没有新会员增加，没有老会员减少
\section{问题分析}
\subsection{问题(1)的分析}
该问题要求研究已发布任务的定价规律，以及任务未完成的原因。根据题目要求，我们首先用散点图粗略地考察了任务价格，任务完成情况以及会员人数的分布情况，注意到分布具有很强的区域性，于是我们用典型回归分析对其相关性进行检验。接着考虑的数据的区域性，我们采用聚簇分析网格法对区域进行划分，在这里我们将经纬度转换为距离，合理选择划分尺度，将大区域划分为多个5*5公里的小区域。接下来对小区域内的数据进行分析，将反应区域会员信息的会员数、配额数、信誉值以及会员流动情况加权得出指标——加权会员数。通过拟合的方法得出区域内任务数、加权会员数以及平均价格的二次拟合曲面，建立了三者间的数学模型，并以此来探讨任务未完成的原因。
\subsection{问题(2)的分析}
该问题要求重新设计定价方案，并与原有方案作比较。问题一中的定价方式综合了任务数和定价以及加权人数的影响，考虑到任务数没有体现任务的完成情况，我们用任务完成率代替任务数来建立新的数学模型。为了制定新的定价方案，并对新旧定价方案进行评价，我们在固定完成度的情况下，将总支出作为评价指标。通过贪心算法，多次迭代得出新的定价方案，并和问题一中的定价作出比较。
\subsection{问题(3)的分析}
此问要求将位置集中的任务进行打包，制定打包后定价策略，并分析影响。考虑到任务的分布情况，我们采用k-means聚类分析，将欧式距离作为分类指标，将任务进行分类。接下来我们对分类的任务进行筛选，分类效果差的数据将不进行打包处理，维持原有定价；对打包的数据，我们根据已有任务数据，采用新的定价方案。最后我们分析了新的打包定价模型对原有定价模型的影响。
\subsection{问题(4)的分析}
对于问题(4)，我们考虑其为一个定价模型，我们考虑在问题(2)的基础上，主要把问题(2)中利用的模型应用到上面来。




\section{模型建立与求解}
\subsection{问题(1)的模型建立与求解}
分为数据的预处理，建立任务的关系图，利用典型相关分析对相关性进行检验以及聚簇区域网格化处理几步。
\subsubsection{建立任务的关系图}
在得到数据并初步处理的基础上,我们首先考虑了任务随经纬度分布的情况，从地图上的分析可知，任务集中在广州珠三角一带，于是我们作了散点图以及三维图来表示任务的离散分布情况，通过作图我们得出任务有区域性分布趋势，有三个中心任务分布群，大致为深圳，佛山和东莞的地理位置。
\begin{figure}[htbp] 
\centering
\includegraphics[width=0.5\textwidth]{散点图} 
\caption{定价与经纬度的关系}
\end{figure}
\begin{figure}[htbp] 
\centering
\includegraphics[width=0.5\textwidth]{成功率随区域变化} 
\caption{成功率随区域变化}
\end{figure}
\newpage
然后我们又对会员人数以及定价的分布作了散点图，发现结果与任务分布散点图有较强的吻合，这说明任务分布与会员人数分布以及定价与任务分布有较强的区域性。从这些图当中，我们可以很直观的发现：区域性是影响任务和会员的关键因素。任务总数与总价之间有很明显的线性关系。在结果中可以看出价格的分布与地域有很轻的关联性，其中在同一块区域内的价格分布大体相同，说明区域位置对价格的影响十分显著因此需要通过分区域划分。最后我们通过研究成功率与区域的关系，发现二者之间有很明显的相关关系。

\subsubsection{利用典型相关分析对相关性进行检验}
通过第1步的分析我们初步看出经度与纬度都对定价和完成率有影响，因此我们很自然地想到计算经度纬度与价格以及地区完成度的相关度，但是因为经度与纬度都是变量并且可能对价格以及地区的完成度造成影响，并且二者分别于价格以及完成度做相关性分析得出的举证太过庞大，数学结论并不直观，因此我们通过典型相关分析，将经度与纬度看成一个变量地区，一起计算价格与地区的相关性以及完成度与地区的相关性。我们将$x$作为地区的位置，$y$作为地区的价格，$z$作为不停地区的完成度，分别计算地区与价格，地区与完成度的相关性分析。我们利用MATLAB中的canoncorr()函数，再利用数学来分别求出相关系数。

$X,Y$分别考虑$X,Y$的线性组合$U_1=a^{T}_{1}X$以及$V_1=b^{T}_{1}Y$,其中$a_1=(a_{11},a_{12},\dots,a_{1p})^T$,$b_1=(b_{11},b_{12},\dots,b_{1p})^T$,由于$Var(U_1)=a_{1}^{T}\sum_{11} a_1$,$Var(V_1)=b_{1}^{T}\sum_{22} b_1$,$Cov(U_1,V_1)=a_{1}^{T}\sum_{12} b_1$,则$U_1,V_1$的相关系数为$$\rho_{u_1,v_1}=\frac{a_{1}^{T}\sum_{12} b_1}{\sqrt{a_{1}^{T}\sum_{11} a_1} \sqrt{b_{1}^{T}\sum_{22} b_1}}$$
典型相关分析在约束条件$a_{1}^{T}\sum_{11} a_1=1,b_{1}^{T}\sum_{22} b_1=1$下，求$a_1,b_1$,使得
$\rho_{u_1,v_1}={a_{1}^{T}\sum_{12} b_1}$取得最大值。通过计算我们得出位置与完成度的相关系数为$r_1=0.02034$，位置与价格的相关系数$r_2=0.1218$，位置与会员数的相关系数$r_3=0.2031$,因此得出这些参数与地区的相关性呈弱相关。
\subsubsection{用聚簇网格化对区域进行分析}
因为价格、会员分布以及任务数量都具有区域性，与位置都具有弱相关性，因此我们采用聚簇网格化对区域进行划分。我们将数据的经纬度转化为公里数，计算出在该地区，纬度1度= 111 km，经度1度= 102km，由此将经纬度换算为公里数后将该地区按照公里数分块。根据分析得出，若区域分得过大则区域之间差别可能不明显，若区域分得过小则区域内样本数过少，可能会产生极大的误差。因此我们可以通过网格把该大地区划分为$()$个($5km\times5km$)的小区域。之后我们选取区域内的任务数以及会员人数，我们考虑这两个因素对区域定价的影响。考虑到会员人数并不能完善地反映会员信息，于是我们对会员人数进行加权。会员信息包括会员位置、信誉值以及配额数。因为配额数与信誉值呈正相关，于是我们将配额数作为会员信息的体现。会员的配额情况如下表所示：
\begin{table}[htbp]
\centering
\begin{tabular}{|c|c|}
\hline
配额&人数占比\\
\hline
1 &0.28\\
\hline
2-4&0.33\\
\hline
$\ge5$&0.39\\
\hline
\end{tabular}
\end{table}
\newpage
根据会员比重，我们令加权会员数为$N$,于是有$N=n_1+2(n_2+n_3+n_4)+3n_5$,其中$n_1\ n_2\ n_3\ n_4$代表区域内配额为1,2,3,4的人数，$N_5$代表区域内配额大等于5的人数。

接下来我们又考虑到会员的流动，通过查阅广东居民出行资料，将会员流动半径定为10km，于是某区域的实际流动人数为该地区的加权会员数以及周围相邻8个地区的加权会员数之和，我们将权重设为0.5，得出该地的实际加权会员数$N_2$有关系式如下:$$N_2=N_1+0.5\sum_{j=1}^{8}N_j$$
\ \ \ \ 于是我们考虑用建立一个函数关系式$f(x,y,z)$即均价和完成数和会员加权人数的关系。用拟合的方法，先用一次函数拟合，然后再用二次函数拟合，在用三次函数拟合，最终发现用二次函数的拟合度最好，于是决定采用二次函数拟合，并且得出拟合函数为:

$$f(x,y,z)=p_{00}+p_{10}\times x+ p_{01}\times y+p_{20}\times x^2+p_{11}\times xy,$$
$$p_{00} =75.3,p_{10} =-0.6322,,p_{01} =-0.05331,p_{20} =0.001724$$
$$p_{11}=0.003662,1\le x\le25,0\le y\le300$$

其中$x$为任务总数，$y$为加权人数，$f$表示重新定价后的价格。

\begin{figure}[htbp] 
\centering
\includegraphics[width=0.5\textwidth]{实际加权会员数} 
\caption{实际加权会员数}
\end{figure}
\begin{figure}[htbp] 
\centering
\includegraphics[width=0.5\textwidth]{低完成度点} 
\caption{完成度低于50\%的点}
\end{figure}
经过聚簇分析，我们得出以下结论：

1.高完成率地区与经济发达地区相吻合，说明经济发展程度与任务完成程度呈正相关。

2.在一些郊区，不仅任务完成数高，任务完成率也较高，但是呈现散点分布，说明这些地区可能是旅游景区或者高端住宅区。

3.在地理位置相近的区域，价格对完成率有一定影响，较高的价格会增加任务的吸引力。

4.某些任务完成率低的区域会被告完成率的区域环绕，例如第(22,8)区域，表明这些区域很可能为湖泊或三角洲地区，人迹稀少，完成率较低。

5.会员比较集中的地区完成度较高，考虑是经济较为发达的地区，会员密度会比较大，


\subsection{问题(2)的模型建立与求解}
本环节将根据附录一的任务完成率，在(1)问的基础上，对原有任务进行重新定价。我们以网格作为聚簇的基本单位，使得每个聚簇的任务数在$1-25$之间，每个地区加权人数在$0-300$之间，然后利用曲线的拟合法，得到价格函数$f(x,y,z)$，再利用贪心算法积累局部最优解来得到一个优化方案，实现在任务完成度不变的情况下将总价格降低。
\subsubsection{模型的提出与建立}
从第(1)问我们得出了任务完成率与任务位置的关系以及定价与完成率之间的关系。于是我们统计了原有的定价与完成率的关系，计算出不停价格区间的任务完成率，这些任务与价格之间大致呈线性关系，我们通过现象拟合的思路，用线性回归的方法确定了任务总数与总价的关系，然后又利用散点图做出了完成度低的地区分布，从而求得二者初步关系。我们首先计算出各区域会员的加权人数,用会员人数的信誉值以及会员的活动范围确定。


于是我们考虑用建立一个函数关系式$f(x,y,z)$即均价和完成数和会员加权人数的关系。用拟合的方法，先用一次函数拟合，然后再用二次函数拟合，在用三次函数拟合，最终发现用二次函数的拟合度最好，于是决定采用二次函数拟合，并且得出拟合函数$f(x,y,z)=p_{00}+p_{10}\times x+ p_{01}\times y+p_{20}\times x^2+p_{11}\times xy$，其中$x$为任务总数，$y$为加权人数，$f$表示重新定价后的价格。
\begin{figure}[htbp]  
\centering
\includegraphics[width=0.3\textwidth]{完成率} 
\caption{定价与完成率的关系}
\end{figure}
\newpage
\subsubsection{用贪心算法处理过程}
新的定价方式的目标应该是在降低价格的同时提升完成数，因此我们把这两个因素作为评价价格制定的指标，希望在降低总价格的同时还能增加任务的完成数。从之前的数据中我们得到了影响总价格的两个因素——价格和完成度，而这两个因素之间是相互影响的二者呈正相关，我们无法得出二者对任务完成数的权重影响，不能把他们放到同一个指标里面来衡量，因此我们在固定完成度的情况下，考虑采用贪心(greedy)算法来处理问题，希望积累局部最优解来使定价规律得到优化，对总价格进行调整。我们将各地区的完成度先减一再加一，从中找到价格降低最多的点再进行迭代。我们令$a_i$为第i次迭代时完成度减一时节约的钱，令$b_i$为第i次完成度加一时投入的钱，经过112次迭代后得到了价格的变化，迭代过程如下图所示，：
\begin{figure}[htbp]  
\centering
\includegraphics[width=0.6\textwidth]{迭代} 
\caption{利用贪心算法迭代的过程}
\end{figure}
\newpage
\begin{equation}
m_2=\sum^{130}_{i=1}(a_i-b_i)=9411.54—8210.84=1200.70
\end{equation}
最终我们得到的价格变化为1200.70，即节省1200.7元。

\subsection{问题(3)的模型建立与求解}
\subsubsection{利用k-means 聚类算法对任务进行打包}
从之前的分析中可以看出，任务分布具有很高的区域性，呈簇集形状。于是我们通过k-mean算法对附录一中的数据进行聚类区分。考虑到人们更倾向于在最短的距离内完成任务，获得最多的收益，我们将欧式距离作为分类标准，把距离相近的任务打包为一个新任务，将此新任务所包含的小任务坐标的中心点作为新任务的位置坐标，同时将每个任务对小任务平均距离给出，显示在app上供会员查看。于是我们查找广州居民的出行目的和方式及其比率如下$_{[3]}$：
\\
\centerline{广州不同年龄居民出行目的比较(单位\%)}

\begin{tabular}{|cccccccccc|}

\hline
年龄 &上班&上学&公务&购物&餐饮娱乐&社交&回家&其他&合计\\
\hline
6-12岁 &-&47.31&-&0.65&1.72&0.22&49.89&0.21&100\\
\hline
13-18岁 &0.29&43.55&0.29&3.44&1.72&0.86&49.56&0.29&100\\
\hline
19-28岁 &31.33&5.95&0.92&7.16&3.35&0.61&50.00&0.68&100\\
\hline
29-55岁 &35.60&0.18&1.29&7.51&2.78&0.99&49.86&01.79&100\\
\hline
>55岁 &3.74&0.16&0.43&24.61&9.11&3.63&50.57&7.75&100\\
\hline
\end{tabular}
\\
\\
\centerline{广州不同年龄居民出行方式比较(单位\%)}

\begin{tabular}{|cccccccccc|}

\hline
年龄 &步行&自行车&电瓶车&公共汽车&地铁&单位班车&私家车&出租车&合计\\
\hline
6-12岁 &56.45&4.65&1.06&16.91&5.29&4.65&9.72&1.27&100\\
\hline
13-18岁 &21.02&3.98&0.57&44.89&19.60&3.41&6.25&0.28&100\\
\hline
19-28岁 &14.34&3.43&0.94&0.94&35.62&23.07&16,99&0.26&100\\
\hline
29-55岁 &14.22&4.37&1.02&28.58&13.56&3.33&33.59&1.43&100\\
\hline
>55岁 &65.78&3.35&0.54&20.76&3.73&0.32&4.11&1.41&100\\
\hline
\end{tabular}
\\
\\
可以从图中得出，多数人的出行目的为回家，所以我们把将不具有簇集性的偏远任务单独处理，将打包的数据控制在3-5个为一组，这样可以使得任务间的距离适中，且可以把任务的中心坐标与会员的住所进行距离显示，使得任务与会员回家的目的相关，增加对会员完成任务的吸引力。通过matlab内置的k-means函数，采取欧式距离作为标准，从已知数据中随机产生175个初始质心，将任务分为175类，同时显示新任务中心点和任务距离中心点的平均距离。
\subsubsection{对打包任务的定价}
我们通过k-means算法将原有任务分为178个包之后，产生了178个中心点。由于有一些点离散度不明显也打成包，因此我们将平均距离(包所含任务到包中心的平均距离)大于1.5km的包删除掉，这些剔除掉的点按照第(2)问中的原有方案处理，剔除后有68个包，包含272个小任务，将需要打包的点进行新的定价方式。包中点数任务为2的共有21个，任务为3的有13个，任务为4的有17个，任务为5的有6个，任务大于等于6的有12个。

针对每个簇$i$,我们制定初始定价$P$为包中任务的价格之和，然后我们对每个包的基础定价进行加权处理，。
\begin{table}[htbp]
\centering
\begin{tabular}{|c|c|}
\hline
包中任务数&加权定价\\
\hline
2-3 &$0.8P$\\
\hline
4-6&$0.7P$\\
\hline
$\ge7$&$0.6P$\\
\hline
\end{tabular}
\end{table}
接下来考虑包的完成率。我们令平均完成率为$\gamma$，定义为包内任务完成数与总完成数的比值。当$\gamma    >0.4$,就认为整个包的任务都被完成。采用新的定价方案后的结果如下表：
\begin{table}[htbp]
\centering
\begin{tabular}{|c|c|c|}
\hline
\ &打包前&打包后\\
\hline
总价格&18488&12894.2\\
\hline
总完成任务数&166&$193$\\
\hline
总任务数&272&272\\
\hline
完成率&0.6103&0.71\\
\hline
\end{tabular}
\end{table}
经过打包处理，我们发现任务的总价格大大减小了，总完成任务数增加，完成率也大大提高，证明了我们的算法设计是高效而可靠的。
\subsection{问题(4)的模型建立与求解}
对于问题(4)，我们考虑在问题(2)的基础上，主要把问题(2)中利用贪心算法的模型应用到上面来。


\section{模型评价与推广}
\subsection{模型的优点}
1.建立了任务数量、会员人数、任务完成率的评价指标，并采用曲线拟合的思想方法分析问题，将评价指标用高度以及颜色表示，其连续的变化趋势以及尖点均直观的表示了出来，便于统计和定性的分析

2.在通过典型相关分析算得若相关性后，利用聚簇网格分析法将地区分成很多小部分，从而采用聚簇的思想对大量数据进行筛选和近似处理，所谓“聚簇”是为了提高对于某个属性的搜索或者使用的 效率，因为数据量太多，且不同指标取样点的经纬度不是严格对应的，所以，将地区分为若干块提取特征信息，并选择具有代表意义的网格，最终得出了较一般的定性结论。

3.在打包问题中采用用均值代替几个点的平均价格和平均位置的方法，避免了陷入图论便于点的混乱关系中，具有创新意义。


\subsection{模型的缺点}
1.在问题中我们假设会员的活动范围都是相同的，但实际中不同会员的活动范围是不同的，这与实际情况相比可能会带来误差

2.实际情况中，一个会员很可能同时接几单，并且在附近的地区几乎同时完成

3.实际上，APP的还原人数是会变化的，一般来说会员人数会逐渐增加

4.在第(2)问当中，二次拟合的曲线很可能不准确，划分区域后的样本点太少，导致贪心算法的迭代次数太少，完成度不高。
section{参考文献}
\begin{thebibliography}{9}
\bibitem{1} MATLAB的N个实用技巧, 刘焕近，李鹏等编著
\bibitem{2} 数学模型(第四版)，姜启源 谢金星 叶俊 编
\bibitem{3} 广州市居民出行特征分析及交通发展的对策
\end{thebibliography}

\newpage  
\appendix 
\section{附录}
\paragraph{价格的三维热点图MATLAB代码}
\begin{verbatim}
A=xlsread('附件一：已结束项目任务数据.xls');
x=A(:,1);y=A(:,2);z=A(:,3);

scatter(x,y,5,z)%散点图
xlabel('纬度');
ylabel('经度');
zlabel('价格');
title('价格与经纬度散点图');
colorbar
figure
[X,Y,Z]=griddata(x,y,z,linspace(22.4,23.3)',linspace(113,114.5),'v4');%插值
pcolor(X,Y,Z);shading interp%伪彩色图
xlabel('纬度');grid on;
ylabel('经度');grid on;
zlabel('价格');grid on;
title('价格与经纬度关伪彩色图');
colorbar
figure,contourf(X,Y,Z) %等高线图
xlabel('纬度');
ylabel('经度');
zlabel('价格');
title('价格与经纬度等高线图');
colorbar
figure,surf(X,Y,Z)%三维曲面                    %三维曲面
xlabel('纬度');
ylabel('经度');
zlabel('价格');
title('价格与经纬度三维曲面');
colorbar
\end{verbatim}
\paragraph{经纬度与价格图的MATLAB代码}
\begin{verbatim}
A=xlsread('附件一：已结束项目任务数据.xls');
x=A(:,1);y=A(:,2);z=A(:,3);e=A(:,4)
a=[x,y];
[A,B,r]=canoncorr(z,e)
\end{verbatim}

\end{document}

